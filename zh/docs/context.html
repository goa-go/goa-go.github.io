<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>上下文(Context) | Goa</title>
    <meta name="description" content="基于中间件的轻量级golang web框架">
    
    
    <link rel="preload" href="/assets/css/0.styles.d617ed88.css" as="style"><link rel="preload" href="/assets/js/app.3e43c4b9.js" as="script"><link rel="preload" href="/assets/js/2.8674f6f0.js" as="script"><link rel="preload" href="/assets/js/13.6f37eda1.js" as="script"><link rel="prefetch" href="/assets/js/10.15bd957b.js"><link rel="prefetch" href="/assets/js/11.e0cb8e65.js"><link rel="prefetch" href="/assets/js/12.1adc3f0e.js"><link rel="prefetch" href="/assets/js/14.0237adbb.js"><link rel="prefetch" href="/assets/js/15.ca7b51a2.js"><link rel="prefetch" href="/assets/js/16.ccd6a1fc.js"><link rel="prefetch" href="/assets/js/17.3d40b24e.js"><link rel="prefetch" href="/assets/js/3.6ce05c07.js"><link rel="prefetch" href="/assets/js/4.be9aced9.js"><link rel="prefetch" href="/assets/js/5.159ca874.js"><link rel="prefetch" href="/assets/js/6.c238cccf.js"><link rel="prefetch" href="/assets/js/7.7476fb00.js"><link rel="prefetch" href="/assets/js/8.26295da6.js"><link rel="prefetch" href="/assets/js/9.9fcb8cac.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d617ed88.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh/" class="home-link router-link-active"><!----> <span class="site-name">Goa</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/goa-go/goa/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/context.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/docs/context.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/goa-go/goa" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/goa-go/goa/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/context.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/docs/context.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/goa-go/goa" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/zh/docs/" class="sidebar-link">介绍</a></li><li><a href="/zh/docs/getting-started.html" class="sidebar-link">快速上手</a></li><li><a href="/zh/docs/goa.html" class="sidebar-link">应用程序(Goa)</a></li><li><a href="/zh/docs/context.html" class="active sidebar-link">上下文(Context)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/docs/context.html#field" class="sidebar-link">Field</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#next" class="sidebar-link">Next</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#set" class="sidebar-link">Set</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#get" class="sidebar-link">Get</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#query" class="sidebar-link">Query</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#getquery" class="sidebar-link">GetQuery</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#getqueryarray" class="sidebar-link">GetQueryArray</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#postform" class="sidebar-link">PostForm</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#param" class="sidebar-link">Param</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#parsejson" class="sidebar-link">ParseJSON</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#parsexml" class="sidebar-link">ParseXML</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#parsestring" class="sidebar-link">ParseString</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#parsequery" class="sidebar-link">ParseQuery</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#parseform" class="sidebar-link">ParseForm</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#cookie" class="sidebar-link">Cookie</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#setcookie" class="sidebar-link">SetCookie</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#status" class="sidebar-link">Status</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#getstatus" class="sidebar-link">GetStatus</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#json" class="sidebar-link">JSON</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#xml" class="sidebar-link">XML</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#string" class="sidebar-link">String</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#html" class="sidebar-link">HTML</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#redirect" class="sidebar-link">Redirect</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#setheader" class="sidebar-link">SetHeader</a></li><li class="sidebar-sub-header"><a href="/zh/docs/context.html#error" class="sidebar-link">Error</a></li></ul></li><li><a href="/zh/docs/middleware.html" class="sidebar-link">中间件</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="上下文-context"><a href="#上下文-context" aria-hidden="true" class="header-anchor">#</a> 上下文(Context)</h1> <div class="tip custom-block"><p>Context将net/http的<code>*Request</code>和<code>ResponseWriter</code>对象及其对应的方法封装到单个对象中，方便调用处理请求和响应的方法。</p></div> <h2 id="field"><a href="#field" aria-hidden="true" class="header-anchor">#</a> Field</h2> <table><thead><tr><th>名字</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>Request</td> <td>*http.Request</td> <td>原生net/http的 *Request对象</td></tr> <tr><td>ResponseWriter</td> <td>http.ResponseWriter</td> <td>原生net/http的ResponseWriter对象</td></tr> <tr><td>Method</td> <td>string</td> <td>http请求方式</td></tr> <tr><td>URL</td> <td>*url.URL</td> <td>http请求的URL对象</td></tr> <tr><td>Path</td> <td>string</td> <td>http请求的路径</td></tr> <tr><td>Header</td> <td>http.Header</td> <td>http请求头部</td></tr> <tr><td>Keys</td> <td>map[string]interface{}</td> <td>主要用于中间件之间数据传递，通过<a href="#get">Get</a>、<a href="#set">Set</a>方法使用</td></tr> <tr><td>Handled</td> <td>bool</td> <td>是否绕过goa的响应处理</td></tr></tbody></table> <h2 id="next"><a href="#next" aria-hidden="true" class="header-anchor">#</a> Next</h2> <p><code>Next()</code> 用于调用下一个中间件。</p> <p>不同于koajs，Next方法写在了Context对象中，koajs的next()实际上是dispatch(i + 1)，我们这样做的好处是可以节省dispatch函数传递带来的内存占用，更加高效的同时也可以让代码更加简洁。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// next() 这种方法在v0.4.0移除</span>
app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>goa<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> next <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// do sth</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// do sth</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// c.Next()</span>
app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>goa<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// do sth</span>
  c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// do sth</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>当应用程序中绑定了多个中间件，除了最后一个中间件，<code>c.Next()</code>是必须调用的，否则goa只会执行第一个中间件。</p> <div class="language-go extra-class"><pre class="language-go"><code>app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>goa<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>goa<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>goa<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
  <span class="token comment">//c.Next() 此处可以省略c.Next()</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p>如果这是你第一次接触中间件，查看更多关于<a href="/zh/docs/middleware.html">中间件</a>。</p></div> <h2 id="set"><a href="#set" aria-hidden="true" class="header-anchor">#</a> Set</h2> <p><code>Set(key string, value interface{})</code> 设定Keys。</p> <h2 id="get"><a href="#get" aria-hidden="true" class="header-anchor">#</a> Get</h2> <p><code>Get(key string) (value interface{}, exists bool)</code> 获取指定Keys。</p> <div class="language-go extra-class"><pre class="language-go"><code>c<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
value <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="query"><a href="#query" aria-hidden="true" class="header-anchor">#</a> Query</h2> <p><code>Query(key string) (value string)</code> 获取query指定key的value，若key不存在则返回&quot;&quot;。</p> <p>若Query复杂或需要类型转换，推荐使用<a href="#parsequery">ParseQuery</a>。</p> <h2 id="getquery"><a href="#getquery" aria-hidden="true" class="header-anchor">#</a> GetQuery</h2> <p><code>GetQuery(key string) (value string, exists bool)</code> 同<a href="#query">Query</a>, 额外返回是否存在。</p> <h2 id="getqueryarray"><a href="#getqueryarray" aria-hidden="true" class="header-anchor">#</a> GetQueryArray</h2> <p><code>GetQueryArray(key string) ((value []string, exists bool)</code> 获取query指定key的value数组和是否存在。</p> <h2 id="postform"><a href="#postform" aria-hidden="true" class="header-anchor">#</a> PostForm</h2> <p><code>PostForm(key string) (value string)</code> 获取query指定key的value，若key不存在则返回&quot;&quot;。</p> <p>若form复杂或需要类型转换，推荐使用<a href="#parseform">ParseForm</a>。</p> <h2 id="param"><a href="#param" aria-hidden="true" class="header-anchor">#</a> Param</h2> <p><code>Param(key string) (value string)</code> 获取路由中的参数，若不存在则返回&quot;&quot;。</p> <p>需配合<a href="https://github.com/goa-go/router" target="_blank" rel="noopener noreferrer">router<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>或其他路由中间件使用:</p> <div class="language-go extra-class"><pre class="language-go"><code>r <span class="token operator">:=</span> router<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/example/:key&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>goa<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  key <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="parsejson"><a href="#parsejson" aria-hidden="true" class="header-anchor">#</a> ParseJSON</h2> <p><code>ParseJSON(pointer interface{}) error</code> 解析请求body中的json，pointer必须为指针。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> obj <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  Key <span class="token builtin">string</span> <span class="token string">`json:&quot;key&quot;`</span>
<span class="token punctuation">}</span>
p <span class="token operator">:=</span> <span class="token operator">&amp;</span>obj<span class="token punctuation">{</span><span class="token punctuation">}</span>
c<span class="token punctuation">.</span><span class="token function">ParseJSON</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token operator">...</span>
</code></pre></div><p>还可以通过goa.M使用，实际上goa.M只是<code>map[string]interface{}</code></p> <div class="language-go extra-class"><pre class="language-go"><code>c<span class="token punctuation">.</span><span class="token function">ParseJSON</span><span class="token punctuation">(</span>goa<span class="token punctuation">.</span>M<span class="token punctuation">{</span>
  <span class="token string">&quot;key&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="parsexml"><a href="#parsexml" aria-hidden="true" class="header-anchor">#</a> ParseXML</h2> <p><code>ParseXML(pointer interface{}) error</code> 解析请求body中的xml。同<a href="#parsejson">ParseJSON</a>。</p> <h2 id="parsestring"><a href="#parsestring" aria-hidden="true" class="header-anchor">#</a> ParseString</h2> <p><code>ParseString() (string, error)</code> 读取请求的body。</p> <h2 id="parsequery"><a href="#parsequery" aria-hidden="true" class="header-anchor">#</a> ParseQuery</h2> <p><code>ParseQuery(pointer interface{}) error</code> 解析Query为结构体。若需要使用tag，tag名为query。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  Name    <span class="token builtin">string</span> <span class="token string">`query:&quot;name&quot;`</span>
  Age     <span class="token builtin">int</span>    <span class="token string">`query:&quot;age&quot;`</span>
  Married <span class="token builtin">bool</span>   <span class="token string">`query:&quot;-&quot;`</span> <span class="token comment">// &quot;-&quot;为忽略</span>
<span class="token punctuation">}</span>

p <span class="token operator">:=</span> <span class="token operator">&amp;</span>Person<span class="token punctuation">{</span><span class="token punctuation">}</span>
c<span class="token punctuation">.</span><span class="token function">ParseQuery</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
</code></pre></div><h2 id="parseform"><a href="#parseform" aria-hidden="true" class="header-anchor">#</a> ParseForm</h2> <p><code>ParseForm(pointer interface{}) error</code> 解析form为结构体，标签名为form。同<a href="#parsequery">ParseQuery</a>。</p> <h2 id="cookie"><a href="#cookie" aria-hidden="true" class="header-anchor">#</a> Cookie</h2> <p><code>Cookie(name string) (string, error)</code> 解析请求中携带的cookie，若对应名称的cookie
不存在则返回<code>ErrNoCookie</code>。</p> <h2 id="setcookie"><a href="#setcookie" aria-hidden="true" class="header-anchor">#</a> SetCookie</h2> <p><code>SetCookie(cookie *http.Cookie)</code> 设定cookie，需使用http包。</p> <div class="language-go extra-class"><pre class="language-go"><code>  c<span class="token punctuation">.</span><span class="token function">SetCookie</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>http<span class="token punctuation">.</span>Cookie<span class="token punctuation">{</span>
    Name<span class="token punctuation">:</span>     <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
    Value<span class="token punctuation">:</span>    <span class="token string">&quot;goa&quot;</span><span class="token punctuation">,</span>
    MaxAge<span class="token punctuation">:</span>   <span class="token number">1</span><span class="token punctuation">,</span>
    Path<span class="token punctuation">:</span>     <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
    Domain<span class="token punctuation">:</span>   <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
    Secure<span class="token punctuation">:</span>   <span class="token boolean">true</span><span class="token punctuation">,</span>
    HttpOnly<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="status"><a href="#status" aria-hidden="true" class="header-anchor">#</a> Status</h2> <p><code>Status(code int)</code> 设置http状态码。</p> <p>当没设定状态码时，若正常响应，则会自动设定为200，否则默认为404。</p> <h2 id="getstatus"><a href="#getstatus" aria-hidden="true" class="header-anchor">#</a> GetStatus</h2> <p><code>GetStatus() (code int)</code> 获取当前设定的状态码，不一定是最后响应的状态码，
再次设定状态码或者 <code>c.Error(...)</code> 都可以改变最后响应的状态码。</p> <h2 id="json"><a href="#json" aria-hidden="true" class="header-anchor">#</a> JSON</h2> <p><code>JSON(json interface{})</code> 响应json数据，会自动响应200状态码、自动设置http响应头部的<code>Content-Type</code>。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> obj <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  Key <span class="token builtin">string</span> <span class="token string">`json:&quot;key&quot;`</span>
<span class="token punctuation">}</span>
p <span class="token operator">:=</span> Person<span class="token punctuation">{</span>
  Key<span class="token punctuation">:</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
</code></pre></div><h2 id="xml"><a href="#xml" aria-hidden="true" class="header-anchor">#</a> XML</h2> <p><code>XML(xml interface{})</code> 响应xml数据，同<a href="#json">JSON</a>。</p> <h2 id="string"><a href="#string" aria-hidden="true" class="header-anchor">#</a> String</h2> <p><code>String(str string)</code> 响应字符串，http头部的<code>Content-Type</code>会被设置为<code>text/plain; charset=utf-8</code>。</p> <h2 id="html"><a href="#html" aria-hidden="true" class="header-anchor">#</a> HTML</h2> <p><code>HTML(html string)</code> 响应html，与<code>c.String</code>类似，但http头部的<code>Content-Type</code>会被设置为<code>text/html; charset=utf-8</code>。</p> <h2 id="redirect"><a href="#redirect" aria-hidden="true" class="header-anchor">#</a> Redirect</h2> <p><code>Redirect(code int, url string)</code> 重定向，会绕过goa的响应处理。</p> <h2 id="setheader"><a href="#setheader" aria-hidden="true" class="header-anchor">#</a> SetHeader</h2> <p><code>SetHeader(key string, value string)</code> 设置http响应头部。</p> <h2 id="error"><a href="#error" aria-hidden="true" class="header-anchor">#</a> Error</h2> <p><code>Error(code int, msg string)</code> 抛出http错误，并且会被goa捕捉来响应错误。</p> <div class="language-go extra-class"><pre class="language-go"><code>c<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">StatusText</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 在这之后的操作都会跳过</span>
c<span class="token punctuation">.</span><span class="token function">Status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment">// 这不会起作用。</span>
c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 这也不会起作用。</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/goa-go/docs/edit/master/docs/zh/docs/context.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2019-11-03 09:31:49</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/zh/docs/goa.html" class="prev">
          应用程序(Goa)
        </a></span> <span class="next"><a href="/zh/docs/middleware.html">
          中间件
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.3e43c4b9.js" defer></script><script src="/assets/js/2.8674f6f0.js" defer></script><script src="/assets/js/13.6f37eda1.js" defer></script>
  </body>
</html>
